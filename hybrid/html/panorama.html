<!DOCTYPE html>
<html dir="ltr" mozdisallowselectionprint>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="google" content="notranslate">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photo-sphere-viewer@4/dist/photo-sphere-viewer.min.css"/>
    
    <script src="https://cdn.jsdelivr.net/npm/three/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uevent@2/browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/photo-sphere-viewer@4/dist/photo-sphere-viewer.min.js"></script>
    <style type="text/css">
        html,body{
            height:100%;
            margin:0;
            padding:0;
        }
        body{
            background: rgba(0,0,0,.5);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
    </style>
  </head>

    <body >
        <div class="clsModal" style="flex:1" > </div>
        <div id="viewer" style="height:60vh;"> </div>
        <div class="clsModal" style="flex:1"> </div>
    </body>
    <script type="text/javascript">
      var userAgent = navigator.userAgent;
      if (userAgent.indexOf('AlipayClient') > -1) {
        // 支付宝小程序的 JS-SDK 防止 404 需要动态加载，如果不需要兼容支付宝小程序，则无需引用此 JS 文件。
        document.writeln('<script src="https://appx/web-view.min.js"' + '>' + '<' + '/' + 'script>');
      } else if (/QQ/i.test(userAgent) && /miniProgram/i.test(userAgent)) {
        // QQ 小程序
        document.write('<script type="text/javascript" src="https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js"><\/script>');
      } else if (/miniProgram/i.test(userAgent) || /MicroMessenger/i.test(userAgent)) {
        // 微信小程序 JS-SDK 如果不需要兼容微信小程序，则无需引用此 JS 文件。
        document.write('<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"><\/script>');
      } else if (/toutiaomicroapp/i.test(userAgent)) {
        // 字节跳动小程序 JS-SDK 如果不需要兼容字节跳动小程序，则无需引用此 JS 文件。
        document.write('<script type="text/javascript" src="https://s3.pstatp.com/toutiao/tmajssdk/jssdk-1.0.1.js"><\/script>');
      } else if (/swan/i.test(userAgent)) {
        // 百度小程序 JS-SDK 如果不需要兼容百度小程序，则无需引用此 JS 文件。
        document.write('<script type="text/javascript" src="https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.18.js"><\/script>');
      }
      // if (!/toutiaomicroapp/i.test(userAgent)) {
      //   document.querySelector('.post-message-section').style.visibility = 'visible';
      // }
    </script>
    <!-- uni 的 SDK -->
    <script type="text/javascript" src="https://js.cdn.aliyun.dcloud.net.cn/dev/uni-app/uni.webview.1.5.2.js"></script>
    <script type="text/javascript">
        document.addEventListener('UniAppJSBridgeReady', function() {
            console.log(34343)
            document.querySelectorAll('.clsModal').forEach((item,key)=>{
                item.addEventListener('click', function() {
                    console.log(2323)
                    //向uniapp传值
                    uni.postMessage({
                        data: {
                            action: 'close'
                        }
                    });
                    // uni.getEnv(function(res) {
                    //     console.log('当前环境：' + JSON.stringify(res));
                    // });
                });
            })
        });
        
        new PhotoSphereViewer.Viewer({
           
             container:document.querySelector('#viewer'),
             panorama: '../../static/background.png',
             autorotateDelay:true, //是否自旋转动
             captureCursor:true,
             autorotateSpeed:0.12943951023931953, // 旋转速度
             size: {
                 width: '100%',
                 height: '60vh'
             },
             caption: '一号地块',
             // time_anim: false,
             // defaultLat: 1.4441088145446443,
             // defaultLong: 0.0800613513013615,
             // sphereCorrection: {pan: 30.01, tilt: 0, roll: 0}, // 校正 低 倾斜 卷
             maxFov: 100,         // 最大缩放值
             minFov: 10,          // 最小缩放值
             defaultZoomLvl: 20,     // 默认缩放值，在1-179之间
             // mousewheel: false,    // 禁止鼠标滚轮缩放
             touchmoveTwoFingers:false,
             moveSpeed: 1, // 鼠标拖拽的速度
             loadingImg: null,
             loadingTxt: "place wait...",
             navbar: false,
             navbar: [
               'autorotate',
               'zoom',
               'caption',
               'fullscreen' //全屏
             ]
         }) 
    </script>
</html>

